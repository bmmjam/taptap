<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>–¢–∞–ø–Ω–∏ –º–µ–Ω—è</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
    <div id="intro-screen">
      <h1>–¢–∞–ø–Ω–∏ –º–µ–Ω—è</h1>
      <p class="subtitle">–£–∑–Ω–∞–π —Å–≤–æ—ë —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</p>
      <p class="hint">–¢–∞–ø–∞–π –ø–æ —Å–º–∞–π–ª–∏–∫—É, –≤–æ–¥–∏ –ø–∞–ª—å—Ü–µ–º ‚Äî –¥–µ–ª–∞–π —á—Ç–æ —á—É–≤—Å—Ç–≤—É–µ—à—å.<br>–£ —Ç–µ–±—è –±—É–¥–µ—Ç 6 —Å–µ–∫—É–Ω–¥.</p>
      <button id="start-btn">–ù–∞—á–∞—Ç—å</button>
    </div>

    <div id="survey-screen" class="hidden">
      <h2 class="survey-title">–ö–∞–∫ —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å?</h2>
      <p class="survey-hint">–û—Ç–≤–µ—Ç—å —á–µ—Å—Ç–Ω–æ ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å</p>

      <div class="sam-scale" data-scale="valence">
        <p class="sam-label">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</p>
        <div class="sam-row">
          <span class="sam-anchor">üò¢</span>
          <div class="sam-circles">
            <div class="sam-circle" data-value="1">1</div>
            <div class="sam-circle" data-value="2">2</div>
            <div class="sam-circle" data-value="3">3</div>
            <div class="sam-circle" data-value="4">4</div>
            <div class="sam-circle" data-value="5">5</div>
          </div>
          <span class="sam-anchor">üòä</span>
        </div>
      </div>

      <div class="sam-scale" data-scale="arousal">
        <p class="sam-label">–≠–Ω–µ—Ä–≥–∏—è</p>
        <div class="sam-row">
          <span class="sam-anchor">üò¥</span>
          <div class="sam-circles">
            <div class="sam-circle" data-value="1">1</div>
            <div class="sam-circle" data-value="2">2</div>
            <div class="sam-circle" data-value="3">3</div>
            <div class="sam-circle" data-value="4">4</div>
            <div class="sam-circle" data-value="5">5</div>
          </div>
          <span class="sam-anchor">ü§Ø</span>
        </div>
      </div>

      <div class="sam-scale" data-scale="dominance">
        <p class="sam-label">–ö–æ–Ω—Ç—Ä–æ–ª—å</p>
        <div class="sam-row">
          <span class="sam-anchor">ü´†</span>
          <div class="sam-circles">
            <div class="sam-circle" data-value="1">1</div>
            <div class="sam-circle" data-value="2">2</div>
            <div class="sam-circle" data-value="3">3</div>
            <div class="sam-circle" data-value="4">4</div>
            <div class="sam-circle" data-value="5">5</div>
          </div>
          <span class="sam-anchor">üí™</span>
        </div>
      </div>

      <div class="emotion-picker">
        <p class="sam-label">–ß—Ç–æ –±–ª–∏–∂–µ –≤—Å–µ–≥–æ?</p>
        <div class="emotion-grid">
          <div class="emotion-option" data-emotion="stressed">üò§<span>–°—Ç—Ä–µ—Å—Å</span></div>
          <div class="emotion-option" data-emotion="excited">ü§©<span>–≠–Ω–µ—Ä–≥–∏—è</span></div>
          <div class="emotion-option" data-emotion="calm">üòå<span>–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</span></div>
          <div class="emotion-option" data-emotion="anxious">üòü<span>–¢—Ä–µ–≤–æ–≥–∞</span></div>
          <div class="emotion-option" data-emotion="focused">üßê<span>–§–æ–∫—É—Å</span></div>
          <div class="emotion-option" data-emotion="sad">üòî<span>–ì—Ä—É—Å—Ç—å</span></div>
        </div>
      </div>

      <button id="survey-next-btn" disabled>–î–∞–ª–µ–µ</button>
    </div>

    <div id="countdown-screen" class="hidden">
      <p class="countdown-hint">–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Å—è —Ç–∞–ø–∞—Ç—å –ø–æ —Å–º–∞–π–ª–∏–∫—É!</p>
      <div id="countdown-number">3</div>
    </div>

    <div id="tap-screen" class="hidden">
      <div id="timer-bar"><div id="timer-fill"></div></div>
      <canvas id="trail-canvas"></canvas>
      <div id="tap-area">
        <div id="face-container">
          <svg id="face" viewBox="0 0 200 200" width="200" height="200">
            <circle id="face-bg" cx="100" cy="100" r="95" fill="#FFD93D" stroke="#E8B830" stroke-width="3"/>
            <ellipse id="eye-left" cx="70" cy="82" rx="8" ry="10" fill="#333"/>
            <ellipse id="eye-right" cx="130" cy="82" rx="8" ry="10" fill="#333"/>
            <path id="mouth" d="M 60 125 Q 100 160 140 125" stroke="#333" stroke-width="4" fill="none" stroke-linecap="round"/>
          </svg>
          <div id="pulse-ring"></div>
        </div>
        <p id="tap-counter">0 —Ç–∞–ø–æ–≤</p>
        <p class="hint" id="gyro-hint"></p>
      </div>
      <button id="done-btn">–ì–æ—Ç–æ–≤–æ</button>
    </div>

    <div id="result-screen" class="hidden">
      <div id="thinking" class="hidden">
        <svg id="thinking-face" viewBox="0 0 200 200" width="120" height="120">
          <circle cx="100" cy="100" r="95" fill="#FFD93D" stroke="#E8B830" stroke-width="3"/>
          <ellipse cx="70" cy="82" rx="8" ry="10" fill="#333"/>
          <ellipse cx="130" cy="82" rx="8" ry="10" fill="#333"/>
          <line x1="65" y1="130" x2="135" y2="130" stroke="#333" stroke-width="4" stroke-linecap="round"/>
        </svg>
        <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é...</p>
      </div>
      <div id="result-card" class="hidden">
        <div id="result-emoji"></div>
        <h2 id="result-emotion"></h2>
        <p id="result-description"></p>
        <div id="result-advice">
          <h3>–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:</h3>
          <ul id="advice-list"></ul>
        </div>
        <div id="result-stats"></div>
        <div id="feedback-section" class="hidden">
          <div class="feedback-divider"></div>
          <p class="feedback-question">–ù–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ?</p>
          <div class="star-rating" id="star-rating">
            <span class="star" data-value="1">‚òÖ</span>
            <span class="star" data-value="2">‚òÖ</span>
            <span class="star" data-value="3">‚òÖ</span>
            <span class="star" data-value="4">‚òÖ</span>
            <span class="star" data-value="5">‚òÖ</span>
          </div>
          <div id="feedback-correction" class="hidden">
            <p class="feedback-question">–ê —á—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ?</p>
            <div class="emotion-grid emotion-grid-small">
              <div class="emotion-option" data-emotion="stressed">üò§<span>–°—Ç—Ä–µ—Å—Å</span></div>
              <div class="emotion-option" data-emotion="excited">ü§©<span>–≠–Ω–µ—Ä–≥–∏—è</span></div>
              <div class="emotion-option" data-emotion="calm">üòå<span>–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</span></div>
              <div class="emotion-option" data-emotion="anxious">üòü<span>–¢—Ä–µ–≤–æ–≥–∞</span></div>
              <div class="emotion-option" data-emotion="focused">üßê<span>–§–æ–∫—É—Å</span></div>
              <div class="emotion-option" data-emotion="sad">üòî<span>–ì—Ä—É—Å—Ç—å</span></div>
            </div>
          </div>
          <button id="feedback-done-btn" disabled>–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div id="post-feedback-buttons" class="hidden">
          <button id="group-btn">–û–±—â–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞</button>
          <button id="retry-btn" class="secondary">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
        </div>
      </div>
    </div>

    <div id="group-screen" class="hidden">
      <h2 id="group-title">–û–±—â–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞</h2>
      <p id="group-count"></p>
      <div id="group-dominant"></div>
      <p id="group-error"></p>
      <div id="group-loading" class="group-loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

      <div class="chart-container" id="emotion-chart-wrap">
        <p class="chart-label">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏–π</p>
        <canvas id="emotion-chart"></canvas>
      </div>

      <div class="chart-container" id="taps-chart-wrap">
        <p class="chart-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–ø–æ–≤</p>
        <canvas id="taps-chart"></canvas>
      </div>

      <h3 class="members-title">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h3>
      <div id="members-list"></div>

      <button id="back-result-btn" class="secondary">–ù–∞–∑–∞–¥ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</button>
      <button id="group-retry-btn" class="secondary">–ï—â—ë —Ä–∞–∑</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
